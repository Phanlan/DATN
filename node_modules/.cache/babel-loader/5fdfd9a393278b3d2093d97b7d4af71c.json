{"ast":null,"code":"import _asyncToGenerator from \"D:/eway/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _slicedToArray from \"D:/eway/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\n\nvar _jsxFileName = \"D:\\\\eway\\\\src\\\\pages\\\\OrganizationCustomer\\\\Create\\\\ContactInfomation.js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport _regeneratorRuntime from \"D:\\\\eway\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";\nimport React, { useContext, useState, useEffect, useCallback } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { usePosition } from \"use-position\";\nimport { GoogleMap, LoadScript, Marker, StandaloneSearchBox } from '@react-google-maps/api';\nimport Geocode from \"react-geocode\";\nimport { InputTextController } from '../../../components/PromotionComponent/InputTextController';\nimport { DropdownController } from '../../../components/PromotionComponent/DropdownController';\nimport { Loading } from '../../../components/Loading';\nimport { GeoService } from '../../../service/GeoService';\nimport { ToastContext } from '../../../App';\nimport { Const } from '../../../utilities';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport var ContactInformation = function ContactInformation(props) {\n  _s();\n\n  var control = props.control,\n      errors = props.errors,\n      setValue = props.setValue;\n  var toast = useContext(ToastContext);\n\n  var _useTranslation = useTranslation('common'),\n      _useTranslation2 = _slicedToArray(_useTranslation, 2),\n      t = _useTranslation2[0],\n      i18n = _useTranslation2[1];\n\n  var currentPosition = usePosition();\n  var geoService = new GeoService();\n\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      center = _useState2[0],\n      setCenter = _useState2[1];\n\n  var _useState3 = useState(null),\n      _useState4 = _slicedToArray(_useState3, 2),\n      searchBox = _useState4[0],\n      setSearchBox = _useState4[1];\n\n  var _useState5 = useState([]),\n      _useState6 = _slicedToArray(_useState5, 2),\n      countries = _useState6[0],\n      setCountries = _useState6[1];\n\n  var _useState7 = useState([]),\n      _useState8 = _slicedToArray(_useState7, 2),\n      stateProvinces = _useState8[0],\n      setStateProvinces = _useState8[1];\n\n  var _useState9 = useState([]),\n      _useState10 = _slicedToArray(_useState9, 2),\n      districts = _useState10[0],\n      setDistricts = _useState10[1];\n\n  var _useState11 = useState([]),\n      _useState12 = _slicedToArray(_useState11, 2),\n      wards = _useState12[0],\n      setWards = _useState12[1];\n\n  var _useState13 = useState(false),\n      _useState14 = _slicedToArray(_useState13, 2),\n      loading = _useState14[0],\n      setLoading = _useState14[1];\n\n  var libraries = ['places'];\n\n  var getFormErrorMessage = function getFormErrorMessage(name) {\n    var _errors$name;\n\n    return errors[name] && /*#__PURE__*/_jsxDEV(\"small\", {\n      className: \"p-error\",\n      children: (_errors$name = errors[name]) === null || _errors$name === void 0 ? void 0 : _errors$name.message\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 36,\n      columnNumber: 32\n    }, _this);\n  };\n\n  useEffect(function () {\n    init(); // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  useEffect(function () {\n    if (currentPosition !== null && currentPosition !== void 0 && currentPosition.latitude && currentPosition !== null && currentPosition !== void 0 && currentPosition.longitude) {\n      setCenter({\n        lat: currentPosition === null || currentPosition === void 0 ? void 0 : currentPosition.latitude,\n        lng: currentPosition === null || currentPosition === void 0 ? void 0 : currentPosition.longitude\n      });\n      getPosition(currentPosition === null || currentPosition === void 0 ? void 0 : currentPosition.latitude.toString(), currentPosition === null || currentPosition === void 0 ? void 0 : currentPosition.longitude.toString());\n    } // eslint-disable-next-line react-hooks/exhaustive-deps\n\n  }, [currentPosition === null || currentPosition === void 0 ? void 0 : currentPosition.latitude, currentPosition === null || currentPosition === void 0 ? void 0 : currentPosition.longitude]);\n  useEffect(function () {\n    if (center !== null && center !== void 0 && center.lat && center !== null && center !== void 0 && center.lng) {\n      setValue('latitude', center.lat);\n      setValue('longitude', center.lng);\n    } // eslint-disable-next-line react-hooks/exhaustive-deps\n\n  }, [center === null || center === void 0 ? void 0 : center.lat, center === null || center === void 0 ? void 0 : center.lng]);\n  var getPosition = useCallback( /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(lat, lng) {\n      var response, formattedAddress, addComponents;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              setLoading(true);\n              _context.prev = 1;\n              Geocode.setApiKey(Const.GGMAPS.key);\n              Geocode.setLanguage(i18n.language);\n              Geocode.setLocationType(\"ROOFTOP\");\n              _context.next = 7;\n              return Geocode.fromLatLng(lat, lng);\n\n            case 7:\n              response = _context.sent;\n              formattedAddress = response.results[0].formatted_address;\n              addComponents = formattedAddress.split(', ');\n              setPosition(addComponents);\n              _context.next = 16;\n              break;\n\n            case 13:\n              _context.prev = 13;\n              _context.t0 = _context[\"catch\"](1);\n              toast.current.show({\n                severity: 'error',\n                summary: t('errorMessage'),\n                detail: _context.t0,\n                life: 5000\n              });\n\n            case 16:\n              _context.prev = 16;\n              setLoading(false);\n              return _context.finish(16);\n\n            case 19:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[1, 13, 16, 19]]);\n    }));\n\n    return function (_x, _x2) {\n      return _ref.apply(this, arguments);\n    };\n  }(), [countries]);\n  var setPosition = useCallback( /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(addComponents) {\n      var n, countryName, country, data, newStateProvinces, stateProvinceName, stateProvince, newDistricts, districtName, district, newWards, wardName, ward, tarAddress, i;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              n = addComponents.length; // set country from current location\n\n              countryName = addComponents[n - 1] === 'Vietnam' ? 'Viá»‡t Nam' : addComponents[n - 1];\n              country = countries.find(function (elm) {\n                return elm.name === countryName;\n              });\n              setValue('countryGeoId', country);\n              _context2.next = 6;\n              return geoService.getGeoRegionList(country.code, []);\n\n            case 6:\n              data = _context2.sent;\n              newStateProvinces = data.map(function (elm) {\n                return {\n                  name: elm.geoName,\n                  code: elm.geoId\n                };\n              });\n              setStateProvinces(newStateProvinces); // set stateProvinces from current location\n\n              stateProvinceName = addComponents[n - 2];\n              stateProvince = newStateProvinces.find(function (elm) {\n                return elm.name === stateProvinceName;\n              });\n              setValue('stateProvinceGeoId', stateProvince);\n              _context2.next = 14;\n              return geoService.getGeoRegionList(stateProvince.code, []);\n\n            case 14:\n              data = _context2.sent;\n              newDistricts = data.map(function (elm) {\n                return {\n                  name: elm.geoName,\n                  code: elm.geoId\n                };\n              });\n              setDistricts(newDistricts); // set district from current location\n\n              districtName = addComponents[n - 3];\n              district = newDistricts.find(function (elm) {\n                return elm.name === districtName;\n              });\n              setValue('districtId', district);\n              _context2.next = 22;\n              return geoService.getGeoRegionList(district.code, []);\n\n            case 22:\n              data = _context2.sent;\n              newWards = data.map(function (elm) {\n                return {\n                  name: elm.geoName,\n                  code: elm.geoId\n                };\n              });\n              setWards(newWards); // set ward from current location\n\n              wardName = addComponents[n - 4];\n              ward = newWards.find(function (elm) {\n                return elm.name === wardName;\n              });\n              setValue('wardId', ward);\n              tarAddress = '';\n\n              for (i = 0; i < n - 4; i++) {\n                tarAddress += addComponents[i] + ' ';\n              }\n\n              setValue('tarAddress', tarAddress); // eslint-disable-next-line react-hooks/exhaustive-deps\n\n            case 31:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function (_x3) {\n      return _ref2.apply(this, arguments);\n    };\n  }(), [countries]);\n  var init = useCallback( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n    var data;\n    return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            _context3.next = 2;\n            return geoService.getCountries([]);\n\n          case 2:\n            data = _context3.sent;\n            setCountries(data.geoList.map(function (elm) {\n              return {\n                name: elm.geoName,\n                code: elm.geoId\n              };\n            })); // eslint-disable-next-line react-hooks/exhaustive-deps\n\n          case 4:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3);\n  })), []);\n  var changeCountry = useCallback( /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(e) {\n      var data;\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.next = 2;\n              return geoService.getGeoRegionList(e.value.code, []);\n\n            case 2:\n              data = _context4.sent;\n              setStateProvinces(data.map(function (elm) {\n                return {\n                  name: elm.geoName,\n                  code: elm.geoId\n                };\n              })); // eslint-disable-next-line react-hooks/exhaustive-deps\n\n            case 4:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }));\n\n    return function (_x4) {\n      return _ref4.apply(this, arguments);\n    };\n  }(), []);\n  var changeStateProvinces = useCallback( /*#__PURE__*/function () {\n    var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5(e) {\n      var data;\n      return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              _context5.next = 2;\n              return geoService.getGeoRegionList(e.value.code, []);\n\n            case 2:\n              data = _context5.sent;\n              setDistricts(data.map(function (elm) {\n                return {\n                  name: elm.geoName,\n                  code: elm.geoId\n                };\n              })); // eslint-disable-next-line react-hooks/exhaustive-deps\n\n            case 4:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5);\n    }));\n\n    return function (_x5) {\n      return _ref5.apply(this, arguments);\n    };\n  }(), []);\n  var changeDistrict = useCallback( /*#__PURE__*/function () {\n    var _ref6 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6(e) {\n      var data;\n      return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              _context6.next = 2;\n              return geoService.getGeoRegionList(e.value.code, []);\n\n            case 2:\n              data = _context6.sent;\n              setWards(data.map(function (elm) {\n                return {\n                  name: elm.geoName,\n                  code: elm.geoId\n                };\n              })); // eslint-disable-next-line react-hooks/exhaustive-deps\n\n            case 4:\n            case \"end\":\n              return _context6.stop();\n          }\n        }\n      }, _callee6);\n    }));\n\n    return function (_x6) {\n      return _ref6.apply(this, arguments);\n    };\n  }(), []);\n  var onPlacesChanged = useCallback(function () {\n    setLoading(true);\n\n    try {\n      var formattedAddress = searchBox.getPlaces()[0].formatted_address;\n      var addComponents = formattedAddress.split(', ');\n      setCenter({\n        lat: searchBox.getPlaces()[0].geometry.location.lat(),\n        lng: searchBox.getPlaces()[0].geometry.location.lng()\n      });\n      setPosition(addComponents);\n    } catch (error) {\n      toast.current.show({\n        severity: 'error',\n        summary: t('errorMessage'),\n        detail: error,\n        life: 5000\n      });\n    } finally {\n      setLoading(false);\n    } // eslint-disable-next-line react-hooks/exhaustive-deps\n\n  }, [countries, searchBox]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"p-grid\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"p-col-12\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"card p-fluid\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"p-grid\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"p-col-12 p-md-6\",\n            children: [/*#__PURE__*/_jsxDEV(DropdownController, {\n              id: \"countryGeoId\",\n              label: t('customer.countryGeoId'),\n              checkErr: true,\n              callback: changeCountry,\n              options: countries,\n              control: control,\n              getFormErrorMessage: getFormErrorMessage\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 190,\n              columnNumber: 29\n            }, _this), /*#__PURE__*/_jsxDEV(DropdownController, {\n              id: \"stateProvinceGeoId\",\n              label: t('customer.stateProvinceGeoId'),\n              checkErr: true,\n              callback: changeStateProvinces,\n              options: stateProvinces,\n              control: control,\n              getFormErrorMessage: getFormErrorMessage\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 193,\n              columnNumber: 29\n            }, _this), /*#__PURE__*/_jsxDEV(DropdownController, {\n              id: \"districtId\",\n              label: t('customer.districtId'),\n              checkErr: true,\n              callback: changeDistrict,\n              options: districts,\n              control: control,\n              getFormErrorMessage: getFormErrorMessage\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 196,\n              columnNumber: 29\n            }, _this), /*#__PURE__*/_jsxDEV(DropdownController, {\n              id: \"wardId\",\n              label: t('customer.wardId'),\n              checkErr: true,\n              options: wards,\n              control: control,\n              getFormErrorMessage: getFormErrorMessage\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 199,\n              columnNumber: 29\n            }, _this), /*#__PURE__*/_jsxDEV(InputTextController, {\n              id: \"tarAddress\",\n              label: t('customer.tarAddress'),\n              checkErr: true,\n              control: control,\n              getFormErrorMessage: getFormErrorMessage\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 202,\n              columnNumber: 29\n            }, _this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 189,\n            columnNumber: 25\n          }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"p-col-12 p-md-6\",\n            children: [/*#__PURE__*/_jsxDEV(InputTextController, {\n              id: \"telecomNumber\",\n              label: t('customer.telecomNumber'),\n              control: control,\n              getFormErrorMessage: getFormErrorMessage\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 207,\n              columnNumber: 29\n            }, _this), /*#__PURE__*/_jsxDEV(InputTextController, {\n              id: \"emailAddress\",\n              label: t('customer.emailAddress'),\n              control: control,\n              getFormErrorMessage: getFormErrorMessage\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 210,\n              columnNumber: 29\n            }, _this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 206,\n            columnNumber: 25\n          }, _this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 188,\n          columnNumber: 21\n        }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"p-grid\",\n          children: /*#__PURE__*/_jsxDEV(LoadScript, {\n            googleMapsApiKey: Const.GGMAPS.key,\n            libraries: libraries,\n            children: /*#__PURE__*/_jsxDEV(GoogleMap, {\n              mapContainerStyle: {\n                width: '100%',\n                height: '400px'\n              },\n              center: center ? center : {\n                lat: 20.9934632,\n                lng: 105.7865466\n              },\n              zoom: 15,\n              children: [!center && (currentPosition === null || currentPosition === void 0 ? void 0 : currentPosition.latitude) && (currentPosition === null || currentPosition === void 0 ? void 0 : currentPosition.longitude) && /*#__PURE__*/_jsxDEV(Marker, {\n                position: {\n                  lat: currentPosition === null || currentPosition === void 0 ? void 0 : currentPosition.latitude,\n                  lng: currentPosition === null || currentPosition === void 0 ? void 0 : currentPosition.longitude\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 223,\n                columnNumber: 37\n              }, _this), center && /*#__PURE__*/_jsxDEV(Marker, {\n                position: center\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 228,\n                columnNumber: 43\n              }, _this), /*#__PURE__*/_jsxDEV(StandaloneSearchBox, {\n                onLoad: function onLoad(ref) {\n                  return setSearchBox(ref);\n                },\n                onPlacesChanged: onPlacesChanged,\n                children: /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"text\",\n                  placeholder: t('search'),\n                  style: {\n                    boxSizing: \"border-box\",\n                    border: \"1px solid transparent\",\n                    width: \"30em\",\n                    height: \"3em\",\n                    padding: \"0 12px\",\n                    borderRadius: \"3px\",\n                    boxShadow: \"0 2px 6px rgba(0, 0, 0, 0.3)\",\n                    fontSize: \"14px\",\n                    outline: \"none\",\n                    textOverflow: \"ellipses\",\n                    position: \"absolute\",\n                    left: \"40%\",\n                    marginLeft: \"-8em\",\n                    marginTop: \"1em\"\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 231,\n                  columnNumber: 37\n                }, _this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 230,\n                columnNumber: 33\n              }, _this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 216,\n              columnNumber: 29\n            }, _this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 215,\n            columnNumber: 25\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 214,\n          columnNumber: 21\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 17\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 13\n    }, _this), /*#__PURE__*/_jsxDEV(Loading, {\n      visible: loading,\n      onHide: function onHide() {\n        return setLoading(false);\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 246,\n      columnNumber: 13\n    }, _this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 185,\n    columnNumber: 9\n  }, _this);\n};\n\n_s(ContactInformation, \"KvzT+nGH7Mr2fgoMUCyDOVMpe7c=\", false, function () {\n  return [useTranslation, usePosition];\n});\n\n_c = ContactInformation;\n\nvar _c;\n\n$RefreshReg$(_c, \"ContactInformation\");","map":{"version":3,"sources":["D:/eway/src/pages/OrganizationCustomer/Create/ContactInfomation.js"],"names":["React","useContext","useState","useEffect","useCallback","useTranslation","usePosition","GoogleMap","LoadScript","Marker","StandaloneSearchBox","Geocode","InputTextController","DropdownController","Loading","GeoService","ToastContext","Const","ContactInformation","props","control","errors","setValue","toast","t","i18n","currentPosition","geoService","center","setCenter","searchBox","setSearchBox","countries","setCountries","stateProvinces","setStateProvinces","districts","setDistricts","wards","setWards","loading","setLoading","libraries","getFormErrorMessage","name","message","init","latitude","longitude","lat","lng","getPosition","toString","setApiKey","GGMAPS","key","setLanguage","language","setLocationType","fromLatLng","response","formattedAddress","results","formatted_address","addComponents","split","setPosition","current","show","severity","summary","detail","life","n","length","countryName","country","find","elm","getGeoRegionList","code","data","newStateProvinces","map","geoName","geoId","stateProvinceName","stateProvince","newDistricts","districtName","district","newWards","wardName","ward","tarAddress","i","getCountries","geoList","changeCountry","e","value","changeStateProvinces","changeDistrict","onPlacesChanged","getPlaces","geometry","location","error","width","height","ref","boxSizing","border","padding","borderRadius","boxShadow","fontSize","outline","textOverflow","position","left","marginLeft","marginTop"],"mappings":"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","sourcesContent":["import React, { useContext, useState, useEffect, useCallback } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport {usePosition} from \"use-position\";\r\nimport { GoogleMap, LoadScript, Marker, StandaloneSearchBox } from '@react-google-maps/api';\r\nimport Geocode from \"react-geocode\";\r\n\r\nimport { InputTextController } from '../../../components/PromotionComponent/InputTextController';\r\nimport { DropdownController } from '../../../components/PromotionComponent/DropdownController';\r\nimport { Loading } from '../../../components/Loading';\r\n\r\nimport { GeoService } from '../../../service/GeoService';\r\n\r\nimport { ToastContext } from '../../../App';\r\n\r\nimport { Const } from '../../../utilities';\r\n\r\nexport const ContactInformation = (props) => {\r\n    const { control, errors, setValue } = props;\r\n    const toast = useContext(ToastContext);\r\n    const [ t, i18n ] = useTranslation('common');\r\n    const currentPosition = usePosition();\r\n    const geoService = new GeoService();\r\n\r\n    const [ center, setCenter ] = useState(null);\r\n    const [ searchBox, setSearchBox ] = useState(null);\r\n    const [ countries, setCountries ] = useState([]);\r\n    const [ stateProvinces, setStateProvinces ] = useState([]); \r\n    const [ districts, setDistricts ] = useState([]); \r\n    const [ wards, setWards ] = useState([]); \r\n\r\n    const [loading, setLoading] = useState(false);\r\n\r\n    const libraries = ['places'];\r\n\r\n    const getFormErrorMessage = (name) => {\r\n        return errors[name] && <small className=\"p-error\">{errors[name]?.message}</small>\r\n    };\r\n\r\n    useEffect(() => {\r\n        init();\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        \r\n        if (currentPosition?.latitude && currentPosition?.longitude) {\r\n            setCenter({lat: currentPosition?.latitude, lng: currentPosition?.longitude});\r\n            getPosition(currentPosition?.latitude.toString(), currentPosition?.longitude.toString());\r\n        }\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [currentPosition?.latitude, currentPosition?.longitude]);\r\n\r\n    useEffect(() => {\r\n        if (center?.lat && center?.lng) {\r\n            setValue('latitude', center.lat);\r\n            setValue('longitude', center.lng);\r\n        }\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [center?.lat, center?.lng]);\r\n\r\n    const getPosition = useCallback(async (lat, lng) => {\r\n        setLoading(true);\r\n        try {\r\n            Geocode.setApiKey(Const.GGMAPS.key);\r\n            Geocode.setLanguage(i18n.language);\r\n            Geocode.setLocationType(\"ROOFTOP\");\r\n\r\n            let response = await Geocode.fromLatLng(lat, lng);\r\n\r\n            let formattedAddress = response.results[0].formatted_address;\r\n            let addComponents = formattedAddress.split(', ');\r\n            setPosition(addComponents);\r\n        } catch (error) {\r\n            toast.current.show({ severity: 'error', summary: t('errorMessage'), detail: error, life: 5000 });\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [countries]);\r\n\r\n    const setPosition = useCallback(async (addComponents) => {\r\n        let n = addComponents.length;\r\n\r\n        // set country from current location\r\n        let countryName = addComponents[n - 1] === 'Vietnam' ? 'Viá»‡t Nam' : addComponents[n - 1];\r\n        let country = countries.find(elm => elm.name === countryName);\r\n        setValue('countryGeoId', country);\r\n        \r\n        let data = await geoService.getGeoRegionList(country.code, []);\r\n        let newStateProvinces = data.map(elm => {return {name: elm.geoName, code: elm.geoId}});\r\n        setStateProvinces(newStateProvinces);\r\n\r\n        // set stateProvinces from current location\r\n        let stateProvinceName = addComponents[n - 2];\r\n        let stateProvince = newStateProvinces.find(elm => elm.name === stateProvinceName);\r\n        setValue('stateProvinceGeoId', stateProvince);\r\n\r\n        data = await geoService.getGeoRegionList(stateProvince.code, []);\r\n        let newDistricts = data.map(elm => {return {name: elm.geoName, code: elm.geoId}});\r\n        setDistricts(newDistricts);\r\n\r\n        // set district from current location\r\n        let districtName = addComponents[n - 3];\r\n        let district = newDistricts.find(elm => elm.name === districtName);\r\n        setValue('districtId', district);\r\n\r\n        data = await geoService.getGeoRegionList(district.code, []);\r\n        let newWards = data.map(elm => {return {name: elm.geoName, code: elm.geoId}});\r\n        setWards(newWards);\r\n\r\n        // set ward from current location\r\n        let wardName = addComponents[n - 4];\r\n        let ward = newWards.find(elm => elm.name === wardName);\r\n        setValue('wardId', ward);\r\n\r\n        let tarAddress = '';\r\n        for (let i = 0; i < n - 4; i++) {\r\n            tarAddress += addComponents[i] + ' '\r\n        }\r\n        setValue('tarAddress', tarAddress);\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [countries]);\r\n\r\n    const init = useCallback(async () => {\r\n        let data = await geoService.getCountries([]);\r\n        setCountries(data.geoList.map((elm) => {\r\n            return {\r\n                name: elm.geoName,\r\n                code: elm.geoId\r\n            }\r\n        }));\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, []);\r\n\r\n    const changeCountry = useCallback(async (e) => {\r\n        let data = await geoService.getGeoRegionList(e.value.code, []);\r\n        setStateProvinces(data.map((elm) => {\r\n            return {\r\n                name: elm.geoName,\r\n                code: elm.geoId\r\n            }\r\n        }));\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, []);\r\n\r\n    const changeStateProvinces = useCallback(async (e) => {\r\n        let data = await geoService.getGeoRegionList(e.value.code, []);\r\n        setDistricts(data.map((elm) => {\r\n            return {\r\n                name: elm.geoName,\r\n                code: elm.geoId\r\n            }\r\n        }));\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, []);\r\n\r\n    const changeDistrict = useCallback(async (e) => {\r\n        let data = await geoService.getGeoRegionList(e.value.code, []);\r\n        setWards(data.map((elm) => {\r\n            return {\r\n                name: elm.geoName,\r\n                code: elm.geoId\r\n            }\r\n        }));\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, []);\r\n\r\n    const onPlacesChanged = useCallback(() => {\r\n        setLoading(true);\r\n        try {\r\n            let formattedAddress = searchBox.getPlaces()[0].formatted_address;\r\n            let addComponents = formattedAddress.split(', ');\r\n\r\n            setCenter({lat: searchBox.getPlaces()[0].geometry.location.lat(), lng: searchBox.getPlaces()[0].geometry.location.lng()});\r\n            setPosition(addComponents);\r\n        } catch (error) {\r\n            toast.current.show({ severity: 'error', summary: t('errorMessage'), detail: error, life: 5000 });\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [countries, searchBox]);\r\n\r\n    return (\r\n        <div className=\"p-grid\">\r\n            <div className=\"p-col-12\">\r\n                <div className=\"card p-fluid\">\r\n                    <div className=\"p-grid\">\r\n                        <div className=\"p-col-12 p-md-6\">\r\n                            <DropdownController id='countryGeoId' label={t('customer.countryGeoId')} checkErr callback={changeCountry}\r\n                                options={countries} control={control} getFormErrorMessage={getFormErrorMessage} />\r\n\r\n                            <DropdownController id='stateProvinceGeoId' label={t('customer.stateProvinceGeoId')} checkErr callback={changeStateProvinces}\r\n                                options={stateProvinces} control={control} getFormErrorMessage={getFormErrorMessage} />\r\n\r\n                            <DropdownController id='districtId' label={t('customer.districtId')} checkErr callback={changeDistrict}\r\n                                options={districts} control={control} getFormErrorMessage={getFormErrorMessage} />\r\n\r\n                            <DropdownController id='wardId' label={t('customer.wardId')} checkErr\r\n                                options={wards} control={control} getFormErrorMessage={getFormErrorMessage} />\r\n\r\n                            <InputTextController id='tarAddress' label={t('customer.tarAddress')} checkErr\r\n                                control={control} getFormErrorMessage={getFormErrorMessage} />\r\n                        </div>\r\n\r\n                        <div className=\"p-col-12 p-md-6\">\r\n                            <InputTextController id='telecomNumber' label={t('customer.telecomNumber')}\r\n                                control={control} getFormErrorMessage={getFormErrorMessage} />\r\n                            \r\n                            <InputTextController id='emailAddress' label={t('customer.emailAddress')}\r\n                                control={control} getFormErrorMessage={getFormErrorMessage} />\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"p-grid\">\r\n                        <LoadScript googleMapsApiKey={Const.GGMAPS.key} libraries={libraries}> \r\n                            <GoogleMap\r\n                                mapContainerStyle={{width: '100%', height: '400px'}}\r\n                                center={center ? center : {lat: 20.9934632, lng: 105.7865466}}\r\n                                zoom={15}\r\n                            >\r\n                                {   \r\n                                    !center && currentPosition?.latitude && currentPosition?.longitude && \r\n                                    <Marker position={{ \r\n                                        lat: currentPosition?.latitude, \r\n                                        lng: currentPosition?.longitude}} />\r\n                                }\r\n\r\n                                {center &&<Marker position={center} />}\r\n\r\n                                <StandaloneSearchBox onLoad={ref => setSearchBox(ref)} onPlacesChanged={onPlacesChanged}>\r\n                                    <input type=\"text\" placeholder={t('search')}\r\n                                        style={{\r\n                                            boxSizing: `border-box`, border: `1px solid transparent`,\r\n                                            width: `30em`, height: `3em`, padding: `0 12px`,\r\n                                            borderRadius: `3px`, boxShadow: `0 2px 6px rgba(0, 0, 0, 0.3)`,\r\n                                            fontSize: `14px`, outline: `none`, textOverflow: `ellipses`,\r\n                                            position: \"absolute\", left: \"40%\", marginLeft: \"-8em\", marginTop: \"1em\"\r\n                                        }}\r\n                                    />\r\n                                </StandaloneSearchBox>\r\n                            </GoogleMap>\r\n                        </LoadScript>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <Loading visible={loading} onHide={() => setLoading(false)} />\r\n        </div>\r\n    );\r\n}"]},"metadata":{},"sourceType":"module"}