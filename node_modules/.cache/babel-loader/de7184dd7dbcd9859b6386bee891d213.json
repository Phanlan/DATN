{"ast":null,"code":"import _asyncToGenerator from \"D:/eway/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _slicedToArray from \"D:/eway/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\n\nvar _jsxFileName = \"D:\\\\eway\\\\src\\\\pages\\\\SalesDashboard\\\\SalesPieChart.js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport _regeneratorRuntime from \"D:\\\\eway\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";\nimport React, { useCallback, useEffect, useState } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { Button } from 'primereact/button';\nimport { PieChart } from '../../components/Report';\nimport { DialogDateFilter } from './Dialog';\nimport { SalesReportService } from '../../service/SalesReportService';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport var SalesPieChart = function SalesPieChart(props) {\n  _s();\n\n  var options = props.options,\n      cycles = props.cycles,\n      height = props.height;\n\n  var _useState = useState({}),\n      _useState2 = _slicedToArray(_useState, 2),\n      data = _useState2[0],\n      setData = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      display = _useState4[0],\n      setDisplay = _useState4[1];\n\n  var _useState5 = useState({}),\n      _useState6 = _slicedToArray(_useState5, 2),\n      filter = _useState6[0],\n      setFilter = _useState6[1];\n\n  var _useState7 = useState(),\n      _useState8 = _slicedToArray(_useState7, 2),\n      option = _useState8[0],\n      setOption = _useState8[1];\n\n  var _useState9 = useState({}),\n      _useState10 = _slicedToArray(_useState9, 2),\n      cycle = _useState10[0],\n      setCycle = _useState10[1];\n\n  var _useState11 = useState(null),\n      _useState12 = _slicedToArray(_useState11, 2),\n      fromDate = _useState12[0],\n      setFromDate = _useState12[1];\n\n  var _useState13 = useState(null),\n      _useState14 = _slicedToArray(_useState13, 2),\n      toDate = _useState14[0],\n      setToDate = _useState14[1];\n\n  var _useTranslation = useTranslation('common'),\n      _useTranslation2 = _slicedToArray(_useTranslation, 1),\n      t = _useTranslation2[0];\n\n  var filters = [{\n    name: t('report.salesVolumn'),\n    code: 'SALES_VOLUME'\n  }, {\n    name: t('report.salesValue'),\n    code: 'SALES_VALUE'\n  }, {\n    name: t('report.orderVolumn'),\n    code: 'ORDER_VOLUME'\n  }];\n  var init = useCallback( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n    var endDate, startDate, salesReportService, params, res;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            setOption({\n              name: t('report.option'),\n              code: 'option'\n            });\n            setCycle({\n              name: t('report.week'),\n              code: 'week'\n            });\n            setFilter({\n              name: t('report.salesVolumn'),\n              code: 'SALES_VOLUME'\n            });\n            endDate = new Date();\n            startDate = new Date(endDate.getFullYear(), endDate.getMonth(), 1);\n            setToDate(endDate);\n            setFromDate(startDate);\n            salesReportService = new SalesReportService();\n            params = {\n              startDate: startDate.toISOString().slice(0, 10),\n              endDate: endDate.toISOString().slice(0, 10)\n            };\n            _context.next = 11;\n            return salesReportService.olapChartPieSynTorSales(params);\n\n          case 11:\n            res = _context.sent;\n            setData(res); // eslint-disable-next-line react-hooks/exhaustive-deps\n\n          case 13:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  })), []);\n  useEffect(function () {\n    init(); // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  var search = useCallback( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n    var salesReportService, params, res;\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            salesReportService = new SalesReportService();\n            params = {\n              startDate: fromDate.toISOString().slice(0, 10),\n              endDate: toDate.toISOString().slice(0, 10),\n              dateType: cycle.code,\n              filter: filter === null || filter === void 0 ? void 0 : filter.code\n            };\n            _context2.next = 4;\n            return salesReportService.olapChartPieSynTorSales(params);\n\n          case 4:\n            res = _context2.sent;\n            setData(res);\n            setDisplay(false);\n\n          case 7:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  })), [fromDate, toDate, cycle, filter]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"card height-100\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"card-header\",\n        children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n          children: t('report.olapChartPieSynTorSales')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 78,\n          columnNumber: 21\n        }, _this), /*#__PURE__*/_jsxDEV(Button, {\n          icon: \"pi pi-cog\",\n          onClick: function onClick() {\n            return setDisplay(true);\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 21\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 17\n      }, _this), /*#__PURE__*/_jsxDEV(PieChart, {\n        data: data,\n        height: height\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 17\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 13\n    }, _this), /*#__PURE__*/_jsxDEV(DialogDateFilter, {\n      cycles: cycles,\n      filters: filters,\n      search: search,\n      options: options,\n      display: display,\n      setDisplay: setDisplay,\n      filter: filter,\n      setFilter: setFilter,\n      option: option,\n      setOption: setOption,\n      cycle: cycle,\n      setCycle: setCycle,\n      fromDate: fromDate,\n      setFromDate: setFromDate,\n      toDate: toDate,\n      setToDate: setToDate\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 13\n    }, _this)]\n  }, void 0, true);\n};\n\n_s(SalesPieChart, \"wBsWRnbIL8JTa5fnMumT/FMHytU=\", false, function () {\n  return [useTranslation];\n});\n\n_c = SalesPieChart;\n\nvar _c;\n\n$RefreshReg$(_c, \"SalesPieChart\");","map":{"version":3,"sources":["D:/eway/src/pages/SalesDashboard/SalesPieChart.js"],"names":["React","useCallback","useEffect","useState","useTranslation","Button","PieChart","DialogDateFilter","SalesReportService","SalesPieChart","props","options","cycles","height","data","setData","display","setDisplay","filter","setFilter","option","setOption","cycle","setCycle","fromDate","setFromDate","toDate","setToDate","t","filters","name","code","init","endDate","Date","startDate","getFullYear","getMonth","salesReportService","params","toISOString","slice","olapChartPieSynTorSales","res","search","dateType"],"mappings":"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","sourcesContent":["import React, { useCallback, useEffect, useState } from 'react';\r\n\r\nimport { useTranslation } from 'react-i18next';\r\n\r\nimport { Button } from 'primereact/button';\r\n\r\nimport { PieChart } from '../../components/Report';\r\nimport { DialogDateFilter } from './Dialog';\r\n\r\nimport { SalesReportService } from '../../service/SalesReportService';\r\n\r\nexport const SalesPieChart = (props) => {\r\n    const { options, cycles, height } = props;\r\n\r\n    const [data, setData ] = useState({});\r\n    const [display, setDisplay] = useState(false);\r\n\r\n    const [filter, setFilter] = useState({});\r\n    const [option, setOption] = useState();\r\n    const [cycle, setCycle] = useState({});\r\n    const [fromDate, setFromDate] = useState(null);\r\n    const [toDate, setToDate] = useState(null);\r\n\r\n    const [ t ] = useTranslation('common');\r\n\r\n    const filters = [\r\n        {name: t('report.salesVolumn'), code: 'SALES_VOLUME'},\r\n        {name: t('report.salesValue'), code: 'SALES_VALUE'},\r\n        {name: t('report.orderVolumn'), code: 'ORDER_VOLUME'}\r\n    ];\r\n\r\n    const init = useCallback(async () => {\r\n\r\n        setOption({ name: t('report.option'), code: 'option' });\r\n        setCycle({ name: t('report.week'), code: 'week' });\r\n        setFilter({name: t('report.salesVolumn'), code: 'SALES_VOLUME'})\r\n\r\n        let endDate = new Date();\r\n        let startDate = new Date(endDate.getFullYear(), endDate.getMonth(), 1);\r\n        setToDate(endDate);\r\n        setFromDate(startDate);\r\n\r\n        const salesReportService = new SalesReportService();\r\n\r\n        let params = {\r\n            startDate: startDate.toISOString().slice(0,10), \r\n            endDate: endDate.toISOString().slice(0,10)\r\n        }\r\n        let res = await salesReportService.olapChartPieSynTorSales(params);\r\n        setData(res);\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        init();\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, []);\r\n\r\n    const search = useCallback(async () => {\r\n        const salesReportService = new SalesReportService();\r\n\r\n        let params = {\r\n            startDate: fromDate.toISOString().slice(0,10), \r\n            endDate: toDate.toISOString().slice(0,10),\r\n            dateType: cycle.code,\r\n            filter: filter?.code\r\n        }\r\n        let res = await salesReportService.olapChartPieSynTorSales(params);\r\n\r\n        setData(res);\r\n        setDisplay(false);\r\n    }, [fromDate, toDate, cycle, filter]);\r\n\r\n    return (\r\n        <>\r\n            <div className=\"card height-100\">\r\n                <div className=\"card-header\">\r\n                    <h5>{t('report.olapChartPieSynTorSales')}</h5>\r\n                    <Button icon=\"pi pi-cog\" onClick={() => setDisplay(true)} />\r\n                </div>\r\n                <PieChart data={data} height={height} />\r\n            </div>\r\n\r\n            <DialogDateFilter \r\n                cycles={cycles} filters={filters} \r\n                search={search} options={options} \r\n                display={display} setDisplay={setDisplay} \r\n                filter={filter} setFilter={setFilter} \r\n                option={option} setOption={setOption} \r\n                cycle={cycle} setCycle={setCycle} \r\n                fromDate={fromDate} setFromDate={setFromDate} \r\n                toDate={toDate} setToDate={setToDate} \r\n            />\r\n        </>\r\n    );\r\n};\r\n"]},"metadata":{},"sourceType":"module"}