{"ast":null,"code":"import _objectSpread from \"D:/eway/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _slicedToArray from \"D:/eway/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\n\nvar _jsxFileName = \"D:\\\\eway\\\\src\\\\components\\\\POSComponent\\\\TableListOrder.js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect, useRef, useContext } from 'react';\nimport { DataTable } from 'primereact/datatable';\nimport { Column } from 'primereact/column';\nimport { Calendar } from 'primereact/calendar';\nimport { Dropdown } from \"primereact/dropdown\";\nimport './TableListPromotion.css';\nimport { useTranslation } from 'react-i18next';\nimport moment from 'moment';\nimport { ToastContext } from \"../../App\";\nimport { POSService } from '../../service/POSService';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport var TableListOrder = function TableListOrder(props) {\n  _s();\n\n  var _useTranslation = useTranslation('common'),\n      t = _useTranslation.t,\n      i18n = _useTranslation.i18n;\n\n  var posService = new POSService();\n  var toast = useContext(ToastContext);\n  var selectedOder = props.selectedOder,\n      setSelectedOrder = props.setSelectedOrder;\n\n  var _useState = useState({\n    first: 0,\n    rows: 10,\n    page: 0,\n    sortField: \"entryDate\",\n    sortOrder: -1\n  }),\n      _useState2 = _slicedToArray(_useState, 2),\n      lazyParams = _useState2[0],\n      setLazyParams = _useState2[1];\n\n  var _useState3 = useState(0),\n      _useState4 = _slicedToArray(_useState3, 2),\n      totalRecords = _useState4[0],\n      setTotalRecords = _useState4[1];\n\n  var _useState5 = useState([]),\n      _useState6 = _slicedToArray(_useState5, 2),\n      orderList = _useState6[0],\n      setOrderList = _useState6[1];\n\n  var _useState7 = useState(null),\n      _useState8 = _slicedToArray(_useState7, 2),\n      entryDateRange = _useState8[0],\n      setEntryDateRange = _useState8[1];\n\n  var _useState9 = useState(false),\n      _useState10 = _slicedToArray(_useState9, 2),\n      loading = _useState10[0],\n      setLoading = _useState10[1];\n\n  var dt = useRef(null);\n  useEffect(function () {\n    setLoading(true);\n    var params = getParams(lazyParams);\n    posService.getOrderList(params).then(function (data) {\n      setOrderList(data.orderList);\n      setTotalRecords(data.totalRows);\n    }).catch(function (err) {\n      toast.current.show({\n        severity: 'error',\n        summary: 'Error Message',\n        detail: err.response.data.errors,\n        life: 5000\n      });\n    }).finally(function () {\n      setLoading(false);\n    }); // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [lazyParams]);\n\n  var getParams = function getParams(lazyParams) {\n    var params = {};\n    var filters = lazyParams.filters;\n    if (lazyParams.page && lazyParams.page >= 0) params.pageIndex = lazyParams.page;\n    if (lazyParams.rows) params.pageSize = lazyParams.rows;\n    if (lazyParams.sortField && lazyParams.sortOrder) params.orderByField = lazyParams.sortOrder === 1 ? lazyParams.sortField : \"-\" + lazyParams.sortField;\n    params.orderType = 'sales';\n    params.salesChannelEnumId = 'ScPos';\n    params.isByUserLogin = true;\n\n    if (filters && Object.keys(filters).length !== 0) {\n      for (var key in filters) {\n        if (Object.hasOwnProperty.call(filters, key)) {\n          var filter = filters[key];\n          var matchMode = filter.matchMode;\n          var value = filter.value;\n          if (value == null || value === \"\") continue;\n\n          switch (matchMode) {\n            case \"timestamprange\":\n              params[key + \"From\"] = value[0].getTime(); //get beginning of the day\n\n              params[key + \"Thru\"] = value[1].getTime() + 86400000 - 1; //get end of the day\n\n              break;\n\n            case \"contains\":\n              params[key + \"Term\"] = value;\n              break;\n\n            case \"in\":\n              params[key + \"s\"] = value.join();\n              break;\n\n            case \"equals\":\n            case \"not-equals\":\n            case \"greater\":\n            case \"greater-equals\":\n            case \"less\":\n            case \"less-equals\":\n              params[key + \"Str\"] = value;\n              params[key + \"Op\"] = matchMode;\n              break;\n\n            case \"is-not-null\":\n            case \"is-null\":\n              params[key + \"Op\"] = matchMode;\n              break;\n\n            default:\n              break;\n          }\n        }\n      }\n    }\n\n    return params;\n  };\n\n  var filterDate = function filterDate(value, filter) {\n    if (filter === undefined || filter === null || typeof filter === 'string' && filter.trim() === '') {\n      return true;\n    }\n\n    if (value === undefined || value === null) {\n      return false;\n    }\n\n    return value === formatDate(filter);\n  };\n\n  var formatDate = function formatDate(date) {\n    var month = date.getMonth() + 1;\n    var day = date.getDate();\n\n    if (month < 10) {\n      month = '0' + month;\n    }\n\n    if (day < 10) {\n      day = '0' + day;\n    }\n\n    return date.getFullYear() + '-' + month + '-' + day;\n  };\n\n  var IdOderBody = function IdOderBody(rowData) {\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: /*#__PURE__*/_jsxDEV(\"span\", {\n        children: rowData.orderId\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 9\n      }, _this)\n    }, void 0, false);\n  };\n\n  var dayTradingBody = function dayTradingBody(rowData) {\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: /*#__PURE__*/_jsxDEV(\"span\", {\n        children: moment(rowData.entryDate).format('DD/MM/YYYY HH:mm:ss')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 9\n      }, _this)\n    }, void 0, false);\n  };\n\n  var totalOrderBody = function totalOrderBody(rowData) {\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: /*#__PURE__*/_jsxDEV(\"span\", {\n        children: rowData.grandTotal\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 9\n      }, _this)\n    }, void 0, false);\n  };\n\n  var onPage = function onPage(e) {\n    setLazyParams(_objectSpread(_objectSpread({}, lazyParams), e));\n  };\n\n  var onFilter = function onFilter(e) {\n    setLazyParams(_objectSpread(_objectSpread(_objectSpread({}, lazyParams), e), {}, {\n      first: 0\n    }));\n  };\n\n  var onSort = function onSort(e) {\n    setLazyParams(_objectSpread(_objectSpread({}, lazyParams), e));\n  };\n\n  var onFilterDateChange = function onFilterDateChange(e) {\n    var obj = e.target;\n\n    if (obj.id === 'entryDate') {\n      setEntryDateRange(obj.value);\n    }\n\n    if (obj.value == null || obj.value[0] != null && obj.value[1] != null) {\n      //obj.value.map((item) => moment(item).format(\"YYYY-MM-DD\")),\n      dt.current.filter(obj.value, obj.id, \"timestamprange\");\n    } //delete dt.current.props.filters[obj.id];\n\n  };\n\n  var monthNavigatorTemplate = function monthNavigatorTemplate(e) {\n    return /*#__PURE__*/_jsxDEV(Dropdown, {\n      value: e.value,\n      options: e.options,\n      onChange: function onChange(event) {\n        return e.onChange(event.originalEvent, event.value);\n      },\n      style: {\n        lineHeight: 1\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 5\n    }, _this);\n  };\n\n  var yearNavigatorTemplate = function yearNavigatorTemplate(e) {\n    return /*#__PURE__*/_jsxDEV(Dropdown, {\n      value: e.value,\n      options: e.options,\n      onChange: function onChange(event) {\n        return e.onChange(event.originalEvent, event.value);\n      },\n      className: \"p-ml-2\",\n      style: {\n        lineHeight: 1\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 5\n    }, _this);\n  };\n\n  var dateFilter = function dateFilter(id, value) {\n    return /*#__PURE__*/_jsxDEV(Calendar, {\n      id: id,\n      selectionMode: \"range\",\n      readOnlyInput: true,\n      value: value,\n      onChange: onFilterDateChange,\n      placeholder: \"\",\n      locale: i18n.language,\n      monthNavigator: true,\n      yearNavigator: true,\n      showButtonBar: true,\n      yearRange: \"2010:2030\",\n      monthNavigatorTemplate: monthNavigatorTemplate,\n      yearNavigatorTemplate: yearNavigatorTemplate\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 5\n    }, _this);\n  };\n\n  var emptyMessage = /*#__PURE__*/_jsxDEV(\"p\", {\n    style: {\n      textAlign: 'center'\n    },\n    children: t('emptyData')\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 183,\n    columnNumber: 24\n  }, _this);\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"datatable-filter-demo\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"card\",\n      children: /*#__PURE__*/_jsxDEV(DataTable, {\n        ref: dt,\n        value: orderList,\n        filters: lazyParams.filters,\n        className: \"p-datatable-customers\",\n        dataKey: \"orderId\",\n        paginator: true,\n        lazy: true,\n        first: lazyParams.first,\n        rows: lazyParams.rows,\n        onPage: onPage,\n        onFilter: onFilter,\n        onSort: onSort,\n        selectionMode: \"single\",\n        sortField: lazyParams.sortField,\n        sortOrder: lazyParams.sortOrder,\n        rowHover: true,\n        selection: selectedOder,\n        totalRecords: totalRecords,\n        rowsPerPageOptions: [5, 10, 20, 50, 100],\n        paginatorTemplate: \"RowsPerPageDropdown CurrentPageReport FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink\",\n        currentPageReportTemplate: \"{first} - {last} of {totalRecords}\",\n        emptyMessage: emptyMessage,\n        loading: loading,\n        paginatorPosition: \"bottom\",\n        onRowClick: function onRowClick(e) {\n          return setSelectedOrder(e.data);\n        },\n        children: [/*#__PURE__*/_jsxDEV(Column, {\n          field: \"orderId\",\n          filterField: \"orderId\",\n          header: t('pos.idOrder'),\n          body: IdOderBody,\n          sortable: true,\n          filter: true,\n          filterPlaceholder: t('search'),\n          filterMatchMode: \"contains\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 198,\n          columnNumber: 11\n        }, _this), /*#__PURE__*/_jsxDEV(Column, {\n          field: \"entryDate\",\n          filterField: \"grandTotal\",\n          header: t('pos.dayTrading'),\n          body: dayTradingBody,\n          sortable: true,\n          filter: true,\n          filterElement: dateFilter(\"entryDate\", entryDateRange),\n          filterFunction: filterDate\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 201,\n          columnNumber: 11\n        }, _this), /*#__PURE__*/_jsxDEV(Column, {\n          field: \"grandTotal\",\n          filterField: \"grandTotal\",\n          sortable: true,\n          header: t('pos.totalOrder'),\n          body: totalOrderBody,\n          filter: true,\n          filterPlaceholder: t('search')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 204,\n          columnNumber: 11\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 188,\n        columnNumber: 9\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 7\n    }, _this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 186,\n    columnNumber: 5\n  }, _this);\n};\n\n_s(TableListOrder, \"sxjGXPGb9v0ghI4vrN7B6SniYpk=\", false, function () {\n  return [useTranslation];\n});\n\n_c = TableListOrder;\n\nvar _c;\n\n$RefreshReg$(_c, \"TableListOrder\");","map":{"version":3,"sources":["D:/eway/src/components/POSComponent/TableListOrder.js"],"names":["React","useState","useEffect","useRef","useContext","DataTable","Column","Calendar","Dropdown","useTranslation","moment","ToastContext","POSService","TableListOrder","props","t","i18n","posService","toast","selectedOder","setSelectedOrder","first","rows","page","sortField","sortOrder","lazyParams","setLazyParams","totalRecords","setTotalRecords","orderList","setOrderList","entryDateRange","setEntryDateRange","loading","setLoading","dt","params","getParams","getOrderList","then","data","totalRows","catch","err","current","show","severity","summary","detail","response","errors","life","finally","filters","pageIndex","pageSize","orderByField","orderType","salesChannelEnumId","isByUserLogin","Object","keys","length","key","hasOwnProperty","call","filter","matchMode","value","getTime","join","filterDate","undefined","trim","formatDate","date","month","getMonth","day","getDate","getFullYear","IdOderBody","rowData","orderId","dayTradingBody","entryDate","format","totalOrderBody","grandTotal","onPage","e","onFilter","onSort","onFilterDateChange","obj","target","id","monthNavigatorTemplate","options","event","onChange","originalEvent","lineHeight","yearNavigatorTemplate","dateFilter","language","emptyMessage","textAlign"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef, useContext } from 'react';\r\nimport { DataTable } from 'primereact/datatable';\r\nimport { Column } from 'primereact/column';\r\nimport { Calendar } from 'primereact/calendar';\r\nimport { Dropdown } from \"primereact/dropdown\";\r\n\r\nimport './TableListPromotion.css';\r\nimport { useTranslation } from 'react-i18next';\r\nimport moment from 'moment';\r\n\r\nimport { ToastContext } from \"../../App\";\r\n\r\nimport { POSService } from '../../service/POSService';\r\n\r\nexport const TableListOrder = (props) => {\r\n  const { t, i18n } = useTranslation('common');\r\n  const posService = new POSService();\r\n  const toast = useContext(ToastContext);\r\n\r\n  const { selectedOder, setSelectedOrder } = props;\r\n\r\n  const [lazyParams, setLazyParams] = useState({ first: 0, rows: 10, page: 0, sortField: \"entryDate\", sortOrder: -1 });\r\n  const [totalRecords, setTotalRecords] = useState(0);\r\n  const [orderList, setOrderList] = useState([]);\r\n  const [entryDateRange, setEntryDateRange] = useState(null);\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  const dt = useRef(null);\r\n\r\n  useEffect(() => {\r\n    setLoading(true);\r\n    let params = getParams(lazyParams);\r\n    posService.getOrderList(params).then((data) => {\r\n      setOrderList(data.orderList);\r\n      setTotalRecords(data.totalRows);\r\n    })\r\n      .catch(err => {\r\n        toast.current.show({ severity: 'error', summary: 'Error Message', detail: err.response.data.errors, life: 5000 });\r\n      }).finally(() => {setLoading(false);})\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [lazyParams]);\r\n\r\n  const getParams = (lazyParams) => {\r\n    const params = {};\r\n    const filters = lazyParams.filters;\r\n\r\n    if (lazyParams.page && lazyParams.page >= 0) params.pageIndex = lazyParams.page;\r\n    if (lazyParams.rows) params.pageSize = lazyParams.rows;\r\n    if (lazyParams.sortField && lazyParams.sortOrder) params.orderByField = lazyParams.sortOrder === 1 ? lazyParams.sortField : \"-\" + lazyParams.sortField;\r\n    params.orderType = 'sales';\r\n    params.salesChannelEnumId = 'ScPos';\r\n    params.isByUserLogin = true;\r\n    if (filters && Object.keys(filters).length !== 0) {\r\n      for (const key in filters) {\r\n        if (Object.hasOwnProperty.call(filters, key)) {\r\n          const filter = filters[key];\r\n          const matchMode = filter.matchMode;\r\n          const value = filter.value;\r\n          if (value == null || value === \"\") continue;\r\n          switch (matchMode) {\r\n            case \"timestamprange\":\r\n              params[key + \"From\"] = value[0].getTime(); //get beginning of the day\r\n              params[key + \"Thru\"] = value[1].getTime() + 86400000 - 1; //get end of the day\r\n              break;\r\n            case \"contains\":\r\n              params[key + \"Term\"] = value;\r\n              break;\r\n            case \"in\":\r\n              params[key + \"s\"] = value.join();\r\n              break;\r\n            case \"equals\":\r\n            case \"not-equals\":\r\n            case \"greater\":\r\n            case \"greater-equals\":\r\n            case \"less\":\r\n            case \"less-equals\":\r\n              params[key + \"Str\"] = value;\r\n              params[key + \"Op\"] = matchMode;\r\n              break;\r\n            case \"is-not-null\":\r\n            case \"is-null\":\r\n              params[key + \"Op\"] = matchMode;\r\n              break;\r\n            default:\r\n              break;\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    return params;\r\n  };\r\n\r\n  const filterDate = (value, filter) => {\r\n    if (filter === undefined || filter === null || (typeof filter === 'string' && filter.trim() === '')) {\r\n      return true;\r\n    }\r\n\r\n    if (value === undefined || value === null) {\r\n      return false;\r\n    }\r\n\r\n    return value === formatDate(filter);\r\n  };\r\n\r\n  const formatDate = (date) => {\r\n    let month = date.getMonth() + 1;\r\n    let day = date.getDate();\r\n\r\n    if (month < 10) {\r\n      month = '0' + month;\r\n    }\r\n\r\n    if (day < 10) {\r\n      day = '0' + day;\r\n    }\r\n\r\n    return date.getFullYear() + '-' + month + '-' + day;\r\n  };\r\n\r\n  const IdOderBody = (rowData) => {\r\n    return (\r\n      <>\r\n        <span>{rowData.orderId}</span>\r\n      </>\r\n    );\r\n  };\r\n\r\n  const dayTradingBody = (rowData) => {\r\n    return (\r\n      <>\r\n        <span>{moment(rowData.entryDate).format('DD/MM/YYYY HH:mm:ss')}</span>\r\n      </>\r\n    );\r\n  };\r\n\r\n  const totalOrderBody = (rowData) => {\r\n    return (\r\n      <>\r\n        <span>{rowData.grandTotal}</span>\r\n      </>\r\n    );\r\n  };\r\n\r\n  const onPage = (e) => {\r\n    setLazyParams({ ...lazyParams, ...e });\r\n  };\r\n\r\n  const onFilter = (e) => {\r\n    setLazyParams({ ...lazyParams, ...e, first: 0 });\r\n  }\r\n\r\n  const onSort = (e) => {\r\n    setLazyParams({ ...lazyParams, ...e });\r\n  }\r\n\r\n  const onFilterDateChange = (e) => {\r\n    let obj = e.target;\r\n\r\n    if (obj.id === 'entryDate') {\r\n      setEntryDateRange(obj.value);\r\n    }\r\n\r\n    if (obj.value == null || (obj.value[0] != null && obj.value[1] != null)) {\r\n      //obj.value.map((item) => moment(item).format(\"YYYY-MM-DD\")),\r\n      dt.current.filter(obj.value, obj.id, \"timestamprange\");\r\n    }\r\n    //delete dt.current.props.filters[obj.id];\r\n  };\r\n\r\n  const monthNavigatorTemplate = (e) =>\r\n    <Dropdown value={e.value} options={e.options} onChange={(event) => e.onChange(event.originalEvent, event.value)} style={{ lineHeight: 1 }}></Dropdown>;\r\n\r\n  const yearNavigatorTemplate = (e) =>\r\n    <Dropdown value={e.value} options={e.options} onChange={(event) => e.onChange(event.originalEvent, event.value)} className=\"p-ml-2\" style={{ lineHeight: 1 }}></Dropdown>;\r\n\r\n\r\n  const dateFilter = (id, value) => (\r\n    <Calendar id={id} selectionMode=\"range\" readOnlyInput value={value} onChange={onFilterDateChange} placeholder=\"\" locale={i18n.language}\r\n      monthNavigator yearNavigator showButtonBar yearRange=\"2010:2030\" monthNavigatorTemplate={monthNavigatorTemplate} yearNavigatorTemplate={yearNavigatorTemplate} ></Calendar>\r\n  );\r\n\r\n  const emptyMessage = <p style={{ textAlign: 'center' }}>{t('emptyData')}</p>;\r\n\r\n  return (\r\n    <div className=\"datatable-filter-demo\">\r\n      <div className=\"card\">\r\n        <DataTable\r\n          ref={dt} value={orderList} filters={lazyParams.filters} className=\"p-datatable-customers\"\r\n          dataKey=\"orderId\" paginator lazy first={lazyParams.first} rows={lazyParams.rows}\r\n          onPage={onPage} onFilter={onFilter} onSort={onSort} selectionMode=\"single\"\r\n          sortField={lazyParams.sortField} sortOrder={lazyParams.sortOrder} rowHover selection={selectedOder}\r\n          totalRecords={totalRecords} rowsPerPageOptions={[5, 10, 20, 50, 100]}\r\n          paginatorTemplate=\"RowsPerPageDropdown CurrentPageReport FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink\"\r\n          currentPageReportTemplate=\"{first} - {last} of {totalRecords}\"\r\n          emptyMessage={emptyMessage} loading={loading} paginatorPosition=\"bottom\" onRowClick={(e) => setSelectedOrder(e.data)}\r\n        >\r\n          <Column field=\"orderId\" filterField=\"orderId\" header={t('pos.idOrder')} body={IdOderBody} sortable\r\n            filter filterPlaceholder={t('search')} filterMatchMode=\"contains\" />\r\n\r\n          <Column field=\"entryDate\" filterField=\"grandTotal\" header={t('pos.dayTrading')} body={dayTradingBody} sortable\r\n            filter filterElement={dateFilter(\"entryDate\", entryDateRange)} filterFunction={filterDate} />\r\n\r\n          <Column field=\"grandTotal\" filterField=\"grandTotal\" sortable header={t('pos.totalOrder')} body={totalOrderBody}\r\n            filter filterPlaceholder={t('search')} />\r\n\r\n          {/* <Column field=\"enteredByPartyId\" header={t('pos.idCus')} body={customerIdBody} filter filterPlaceholder={t('search')} /> */}\r\n        </DataTable>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n"]},"metadata":{},"sourceType":"module"}